\subsubsection{可測関数}

この節では，$Y$ が``数''の空間であるときの可測写像 $f:X\to Y$ の性質を調べる．
\ref{sec:integration} 節で見るようにこれらは``積分できる''関数の候補であって，以後の議論において基本的な役割を演じる．

\begin{definition}\label{def:measurable_function}
    $(X,\Afrak)$ を可測空間，$Y=[-\infty,+\infty]$ または $\Cbb$ とする．
    例 \ref{ex:Borel_algebra}, \ref{ex:extended_real} によって $(Y,\Bfrak(Y))$ も可測空間となる．
    このときの可測写像 $f:X\to Y$ を可測関数 (measurable function) という
    \footnote{このように可測写像と可測関数を呼び分けるのは必ずしも一般的ではないが，ある程度妥当な命名だと思う\cite{ms95741}．}．
    特に，$E\subset\Rbb^n$ に対して，(例 \ref{ex:relative_sigma_algebra} の記法を用いて)
    \begin{enumerate}
        \item $(X,\Afrak)=(E,(\Bfrak^n)_E)$ のとき，$f$ を Borel 可測関数という．
        \item $(X,\Afrak)=(E,(\Bfrak_\Lrm^n)_E)$ のとき，$f$ を Lebesgue 可測関数という
            \footnote{
                積分できる関数を増やしたいという文脈では，できるだけ多くの関数 $f:X\to Y$ が可測になってほしい．
                そのためには $X$ 上の $\sigma$-加法族はできるだけ大きいものを，
                $Y$ 上の $\sigma$-加法族はできるだけ小さいもの (必要最小限の可測集合だけを備えたもの) を選択するのがよさそうである．
                この意味において，($(X,\Afrak)$ 上の測度 $\mu$ が与えられたときに) 測度空間 $(X,\Afrak,\mu)$ として完備なものを選ぶのは理にかなっており，
                $Y$ 上の $\sigma$-加法族として $\Bfrak_\Lrm^1$ などを選ぶのは不合理である．
                実際，$f$ が $\Rbb$-値 や $\Cbb\,(\simeq\Rbb^2)$-値のとき，
                $Y$ 上の $\sigma$-加法族として $\Bfrak_\Lrm^1$ や $\Bfrak_\Lrm^2$ を選ぶこともできるが，
                そのような可測写像はあまり良い性質を持たない．
                たとえば，注意 \ref{rem:Borel_implies_Lebesgue} で見た，連続関数が可測になるという性質はもはや成立しなくなる \cite{mo31603}．

                一方で，常に Lebesgue 可測関数を選ぶ (あるいは，$(X,\Afrak,\mu)$ として完備測度空間を選ぶ) のが良いとは限らない．
                たとえば，注意 \ref{rem:Borel_Lebesgue_composition} で見るように，Lebesgue 可測関数は関数の合成についてよく振る舞わない．
                どのクラスの可測関数を考えるのが適切かはケースバイケースだと思われる．
            }．
    \end{enumerate}
\end{definition}

\begin{remark}
    定義 \ref{def:measurable_function} は次の意味で consistent である：
    \begin{itemize}
        \item 関数 $f:X\to\Rbb$ に対して，$f:X\to[-\infty,+\infty]$ と見なしたときの可測性と
        $f:X\to\Cbb$ と見なしたときの可測性は同値になる．
    \end{itemize}
    {\color{red} TODO why?}
\end{remark}

\begin{remark}\label{rem:Borel_implies_Lebesgue}
    注意 \ref{rem:Borel_Lebesgue} により $\Bfrak^n\subset\Bfrak_\Lrm^n$ なので，Borel 可測関数は Lebesgue 可測である．
    特に命題 \ref{prop:conti_implies_measurable} により，連続関数は Lebesgue 可測である．
\end{remark}

可測関数の特徴づけとして次のことが知られている (こちらを可測関数の定義とすることも多い)．

\begin{proposition}\label{prop:measurable_function_characterization}
    可測空間 $(X,\Afrak)$ に対して次が成り立つ．
    \begin{enumerate}
        \item $f:X\to[-\infty,+\infty]$ が可測関数であることは，次のうち任意の一つと同値．
            \begin{enumerate}
                \item 任意の $a\in\Rbb$ に対して $f^{-1}([-\infty,a))\in\Afrak$．
                \item 任意の $a\in\Rbb$ に対して $f^{-1}([-\infty,a])\in\Afrak$．
                \item 任意の $a\in\Rbb$ に対して $f^{-1}((a,+\infty])\in\Afrak$．
                \item 任意の $a\in\Rbb$ に対して $f^{-1}([a,+\infty])\in\Afrak$．
            \end{enumerate}
        \item $f:X\to\Cbb$ が可測関数であることは，$\Re f:X\to\Rbb,\ \Im f:X\to\Rbb$ が共に可測関数であることと同値．
    \end{enumerate}
\end{proposition}

\begin{proof}
    \textrm{i)} を示す．
    \begin{itemize}[align=left]
        \item[$f$ が可測 $\Rightarrow$ (a)--(d)：]
            明らか．
        \item[(a) $\Rightarrow$ (b)：]
            $\displaystyle f^{-1}([-\infty,a])=\bigcap_{k=1}^\infty f^{-1}\biggl(\biggl[-\infty,a+\frac{1}{k}\biggr)\biggr)\in\Afrak$ より従う．
        \item[(b) $\Rightarrow$ (c)：]
            $\displaystyle f^{-1}((a,+\infty])=X\setminus f^{-1}([-\infty,a])\in\Afrak$ より従う．
        \item[(c) $\Rightarrow$ (d)：]
            $\displaystyle f^{-1}([a,+\infty])=\bigcap_{k=1}^\infty f^{-1}\biggl(\biggl(a-\frac{1}{k},+\infty\biggr]\biggr)\in\Afrak$ より従う．
        \item[(d) $\Rightarrow$ (a)：]
            $\displaystyle f^{-1}([-\infty,a))=X\setminus f^{-1}([a,+\infty])\in\Afrak$ より従う．
        \item[(a), (c) $\Rightarrow$ $f$ が可測：]
            (a), (c) より $\Rbb$ の任意の開区間 $I$ に対して $f^{-1}(I)\in\Afrak$ となる．
            $\Rbb$ の開集合 $O$ は開区間の可算個の和集合として表される\footnote{
                $O$ の各点 $x$ に対して，$x$ を含み $O$ に含まれるような開区間 $I_x$ を取る．
                $\bigcup_{x\in O}I_x=O$ なので，特に $\{I_x\}_{x\in O}$ は $O$ の開被覆である．
                Lindel\"of の被覆定理 \cite[付録 \S2 定理 2]{It63} によって，これらから可算無限個を
                抜き出して，なお $O$ を被覆するようにできる．
            }ので，$f^{-1}(O)\in\Afrak$ も分かる．
            このことと \eqref{eqn:extended_real_topology} より，$[-\infty,+\infty]$ の位相を $\widetilde\Ocal$ として
            \begin{align*}
                \widetilde\Ocal\subset\{A\subset[-\infty,+\infty]\mid f^{-1}(A)\in\Afrak\}
            \end{align*}
            となる．
            この右辺は $[-\infty,+\infty]$ 上の $\sigma$-加法族であるから $\Bfrak([-\infty,+\infty])$ を含む．
            ゆえに $f$ は可測である．
    \end{itemize}
    \textrm{ii)} は命題 \ref{prop:Meas_product} と系 \ref{cor:Borel_product} より直ちに従う．
\end{proof}

\begin{remark}\label{rem:Borel_Lebesgue_composition}
    Borel 可測関数や Lebesgue 可測関数の合成関数の可測性についてまとめておく．

    $E\subset\Rbb^n$ とし，$Y=[-\infty,+\infty]$ または $\Cbb$ とする．
    $f:E\to\Rbb,\ g:\Rbb\to Y$ に対して，$g\circ f$ の可測性は次の表のようになる．

    \begin{table}[h]
        \centering
        \begin{tabular}{|c|c||c|}
            \hline
            $f$ & $g$ & $g\circ f$\\
            \hhline{|=|=#=|}
            Borel 可測 & Borel 可測 & Borel 可測\\
            \hline
            Lebesgue 可測 & Borel 可測 & Lebesgue 可測\\
            \hline
            Borel 可測 & Lebesgue 可測 & 何もいえない\\
            \hline
            Lebesgue 可測 & Lebesgue 可測 & 何もいえない\\
            \hline
        \end{tabular}
    \end{table}

    特に，$g$ が Lebesgue 可測であることしか分かっていないときには，合成関数の可測性については何も保証されないことに注意．
    $1,2$ 行目は可測関数の定義と $\Bfrak^n\subset\Bfrak_\Lrm^n$ から直ちに従う．
    $3$ 行目は反例が \cite[\S2 Exercise 9]{Fo99} や \cite[pp.72--73]{It63} にある．
    $4$ 行目は $3$ 行目から直ちに従う．
\end{remark}

\begin{theorem}\label{thm:elementary_measuable_functions}
    $(X,\Afrak)$ を可測空間とする．
    \begin{enumerate}
        \item 可測関数 $f,g:X\to\Cbb$ と $\alpha\in\Cbb,\ p>0$ に対して，$f+g,\ \alpha f,\ fg,\ |f|^p$ は可測である．
        \item 可測関数列 $(f_n:X\to[-\infty,+\infty])_{n=1}^\infty$ に対して，
            $\displaystyle\sup_{n\ge1}f_n,\ \inf_{n\ge1}f_n,\ \limsup_{n\to\infty}f_n,\ \liminf_{n\to\infty}f_n$ は可測である．
    \end{enumerate}
\end{theorem}

\begin{proof}
    \textrm{i)} を示す．
    命題 \ref{prop:Meas_product} より $(X,\Afrak)\ni x\mapsto(f(x),g(x))\in(\Cbb\times\Cbb,\Bfrak(\Cbb)\otimes\Bfrak(\Cbb))$ は可測．
    また，$\Cbb\times\Cbb\ni(a,b)\mapsto a+b\in\Cbb$ は連続なので命題 \ref{prop:conti_implies_measurable}, \ref{prop:product_compatibility} より可測．
    従って，これらを合成して得られる $f+g$ も可測．
    同様に，$\alpha f$ は $f$ と連続写像 $\Cbb\ni z\mapsto\alpha z\in\Cbb$ を合成して得られるので可測．
    $fg,|f|^p$ についても同様にして示される．

    \textrm{ii)} を示す．
    任意の $a\in\Rbb$ に対して
    \begin{align*}
        \Bigl(\sup_{n\ge1}f_n\Bigr)^{-1}((a,+\infty])
        =\bigcup_{n=1}^\infty f_n^{-1}((a,+\infty])\in\Afrak
    \end{align*}
    と書けるので，命題 \ref{prop:measurable_function_characterization} より $\sup_{n\ge1}f_n$ は可測．
    同様にして $\inf_{n\ge1}f_n$ が可測であることも分かる．
    ゆえに
    \begin{align*}
        \limsup_{n\to\infty}f_n=\inf_{n\ge1}\Bigl(\sup_{m\ge n}f_m\Bigr),\quad
        \liminf_{n\to\infty}f_n=\sup_{n\ge1}\Bigl(\inf_{m\ge n}f_m\Bigr)
    \end{align*}
    も可測．
\end{proof}

\begin{corollary}\label{cor:measurable_function_pointwise_convergence}
    $(X,\Afrak)$ を可測空間，$Y=[-\infty,+\infty]$ または $\Cbb$ とする．
    可測関数列 $(f_n:X\to Y)_{n=1}^\infty$ が関数 $f:X\to Y$ に $X$ 上で各点収束するなら，$f$ も可測である．
\end{corollary}

\begin{proof}
    $Y=[-\infty,+\infty]$ のときは定理 \ref{thm:elementary_measuable_functions} \textrm{ii)} より明らか．
    $Y=\Cbb$ のときは命題 \ref{prop:measurable_function_characterization} \textrm{ii)} よって前者のケースに帰着できる．
\end{proof}

\begin{remark}
    系 \ref{cor:measurable_function_pointwise_convergence} は可測関数の空間が各点収束について閉じていることを意味している．
    これは連続関数の空間との著しい違いである．
    たとえば $X=[0,1],f_n=x^n$ のとき，$(f_n)_{n=1}^\infty$ の各点収束極限 $\chi_{\{1\}}$ は連続ではない．
    「連続関数列の一様収束極限は連続である」という事実は，
    連続関数の空間における系 \ref{cor:measurable_function_pointwise_convergence} の一つの対応物と考えられる．
\end{remark}
